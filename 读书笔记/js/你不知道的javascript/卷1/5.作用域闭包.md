### 闭包

- 产生：当函数可以记住并访问坐在的词法作用域是，即函数实在当前词法作用域之外执行的，就产生了闭包
  - 高阶函数（函数的参数或者返回值是一个函数）
- 作用：
  - 通过持有对作用域的引用，阻止js引擎的垃圾回收器进行释放（这个引用就叫闭包）

### 思考题

```
for (var i=1; i<=5; i++) { (function() { setTimeout( function timer() { console.log( i ); }, i*1000 ); })(); }   //会输出5个6，自执行函数未生效，思考下为啥
```

- 原因在于，这样确实多了五个词法作用域，但均未挂载变量，其实都是空的，改成如下代码就行了(挂载了j)

```
for (var i=1; i<=5; i++) { (function(j) { setTimeout( function timer() { console.log( j ); }, i*1000 ); })(j); }
```

### 模块模式

- 实现条件
  - 必须有外部封闭函数，该函数至少被调用一次
  - 封闭函数必须返回至少一个内部函数，这样才能形成闭包
- 特征
  - 为创建内部作用域而调用了一个包装函数
  - 包装函数的返回值必须至少包括一个对内部函数的引用

- 注意
  - export 是导出 API
  - export default 是导出 对象